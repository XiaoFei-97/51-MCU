//该板子上的O点阵为8*8，只能显示简单的一些汉子，如果要显示真正的汉字
//通过取模软件取的可以选择16*16点阵的板子

#include<reg51.h>
#include<intrins.h>

sbit SRCLK=P3^6;
sbit RCLK=P3^5;
sbit SER=P3^4;

//--定义要使用的IO口--//
#define COMMONPORTS		P0

//--列选通控制--//
unsigned char code TAB[8]  = {0x7f,0xbf,0xdf,0xef,0xf7,0xfb,0xfd,0xfe};

//--点阵字码--//
unsigned char code CHARCODE[16][8]=
{

                 0x00,0x00,0x49,0x49,0x49,0x49,0x3e,0x00,	 //3

				 0x00,0x00,0x21,0x43,0x45,0x49,0x31,0x00,	   //2

				 0x00,0x00,0x00,0x21,0x7f,0x01,0x00,0x00,	  //1
				 0x00,0x40,0x40,0x20,0x00,0x00,0x00,0x00,
				 0x38,0x40,0x40,0x20,0x00,0x00,0x00,0x00,
				 0x38,0x44,0x42,0x21,0x00,0x00,0x00,0x00,
				 0x38,0x44,0x42,0x21,0x01,0x02,0x04,0x00,
				 0x38,0x44,0x42,0x21,0x01,0x02,0x04,0x38,

				 0x38,0x44,0x42,0x21,0x21,0x42,0x44,0x38,
				 0x38,0x7c,0x7e,0x3f,0x3f,0x7e,0x7c,0x38,
				 0x70,0xf8,0xfc,0x7e,0x7e,0xfc,0xf8,0x70,
				 0x38,0x7c,0x7e,0x3f,0x3f,0x7e,0x7c,0x38,
				 0x70,0xf8,0xfc,0x7e,0x7e,0xfc,0xf8,0x70,
				 0x38,0x7c,0x7e,0x3f,0x3f,0x7e,0x7c,0x38,
				 0x70,0xf8,0xfc,0x7e,0x7e,0xfc,0xf8,0x70,
				 0x38,0x7c,0x7e,0x3f,0x3f,0x7e,0x7c,0x38


};
void delay(unsigned int time)
{
  unsigned int i,j;
  for(i=0;i<time;i++)
    for(j=0;j<121;j++);
}

/*******************************************************************************
* 函数名         : Hc595SendByte(unsigned char dat)
* 函数功能		   : 想74H595发送一个字节的数据
* 输入           : 无
* 输出         	 : 无
*******************************************************************************/
void Hc595SendByte(unsigned char dat)
{
	unsigned char a;
	SRCLK=0;
	RCLK=0;
	for(a=0;a<8;a++)
	{
		SER=dat>>7;
		dat<<=1;

		SRCLK=1;
		_nop_();
		_nop_();
		SRCLK=0;	
	}

	RCLK=1;
	_nop_();
	_nop_();
	RCLK=0;
}
/*******************************************************************************
* 函数名         : main
* 函数功能		   : 主函数
* 输入           : 无
* 输出         	 : 无
*******************************************************************************/

void main()
{	
 	unsigned char tab, j;
	unsigned int  i;

	while(1)
	{	
		for(i= 0; i<50; i++ )   //两个字之间的扫描间隔时间
		{
			for(tab=0;tab<8;tab++)
			{	

				Hc595SendByte(0x00);			     //消隐																
				COMMONPORTS	= TAB[tab];				 //输出字码	
				Hc595SendByte(CHARCODE[j][tab]);	
				delay(2);	j++;
		if(j ==16 ) j=0;		
			}
			 
		}
	
		
	}
		
}
